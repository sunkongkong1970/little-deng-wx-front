<view class="page">
	<!-- 个人信息头部卡片 -->
	<view class="profile-card">
		<view class="cover-container" bindtap="previewCoverImage">
			<t-image class="cover-image" src="{{coverImage}}" mode="aspectFill" shape="round" />
			<view class="overlay"></view>
		</view>
		<view class="user-info-container">
			<image class="user-avatar" src="{{userAvatar}}" mode="aspectFill" binderror="onAvatarError" bindload="onAvatarLoad" />
			<text class="user-nickname">{{userNickname}}</text>
		</view>
		<!-- 发布按钮 -->
		<view class="publish-btn" bindtap="goToPublish" catchtap="goToPublish">
			<t-icon name="edit" size="40rpx" color="#fff" />
		</view>
	</view>
	
	<!-- 朋友圈动态列表 -->
	<view class="moments-container">
		<block wx:for="{{posts}}" wx:key="id" wx:for-item="post" wx:for-index="postIndex">
		<view class="moment-card">
			<view class="moment-header">
				<view class="user-section">
					<image class="moment-avatar" src="{{post.avatar}}" mode="aspectFill" />
					<view class="user-info">
						<text class="user-name">{{post.nick}}</text>
						<text class="post-time">{{post.time}}</text>
					</view>
				</view>
			</view>
				
			<view class="moment-content">
				<text class="content-text">{{post.text}}</text>
			</view>
			
			<!-- 图片展示区域 -->
			<view class="moment-images" wx:if="{{post.images && post.images.length > 0}}">
				<image 
					wx:for="{{post.images}}" 
					wx:key="index" 
					wx:for-item="imageUrl" 
					wx:for-index="imgIndex"
					wx:if="{{imgIndex < 9}}"
					class="moment-image moment-image-grid" 
					src="{{imageUrl}}" 
					mode="aspectFill"
					bindtap="previewImage"
					data-urls="{{post.images}}"
					data-current="{{imageUrl}}"
				/>
			</view>
				
				<view class="moment-location" wx:if="{{post.loc}}">
					<t-icon name="location" size="24rpx" color="#0052d9" />
					<text class="location-text">{{post.loc}}</text>
				</view>
				
				<t-divider />
				
			<view class="moment-actions">
				<view class="action-item action-item-horizontal {{post.liked ? 'liked' : ''}}" bindtap="onLike" data-index="{{postIndex}}">
					<t-icon name="{{post.liked ? 'thumb-up-filled' : 'thumb-up'}}" size="36rpx" color="{{post.liked ? '#0052d9' : '#999'}}" />
					<text class="action-text {{post.liked ? 'active' : ''}}">{{post.likeCount > 0 ? post.likeCount : '赞'}}</text>
				</view>
				<view class="action-item action-item-horizontal" bindtap="onComment" data-index="{{postIndex}}">
					<t-icon name="chat" size="36rpx" color="#999" />
					<text class="action-text">评论</text>
				</view>
			</view>
			</view>
		</block>
		
		<!-- 空状态提示 -->
		<view class="empty-container" wx:if="{{posts.length === 0}}">
			<t-empty 
				icon="info-circle" 
				description="还没有朋友圈动态"
			>
				<t-button slot="action" theme="primary" size="medium" bindtap="goToPublish">
					发布第一条动态
				</t-button>
			</t-empty>
		</view>
	</view>
</view>
